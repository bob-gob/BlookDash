<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlookDash | Roman Empire</title>
    <style>
        body {
            background-color: #0b101b;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* Top Bar */
        #top-bar {
            width: 100%;
            background: #161d2b;
            padding: 15px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border-bottom: 3px solid #3498db;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .container {
            padding: 20px;
            text-align: center;
            width: 100%;
            max-width: 800px;
        }

        /* Buttons */
        button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 8px;
            border: none;
            margin: 10px;
            transition: 0.2s;
            font-weight: bold;
        }

        .pack-btn { background: #3498db; color: white; border-bottom: 4px solid #2980b9; }
        .pack-btn:hover { background: #2980b9; transform: translateY(-2px); }

        /* Collection Grid */
        #collection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            width: 100%;
            margin-top: 20px;
        }

        .blook-card {
            background: #1c2331;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border-bottom: 6px solid gray;
            transition: 0.3s;
        }

        .sell-btn {
            background: #e74c3c;
            color: white;
            font-size: 11px;
            padding: 5px;
            margin-top: 10px;
            width: 100%;
            border-bottom: 2px solid #c0392b;
        }

        /* Confirmation Modal */
        #confirmBox {
            display: none; 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: rgba(0,0,0,0.9); 
            z-index: 1000; 
            justify-content: center; 
            align-items: center;
        }

        .modal-content {
            background: #1e2530;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            border: 3px solid #3498db;
            box-shadow: 0 0 30px rgba(52, 152, 219, 0.4);
        }
    </style>
</head>
<body>

    <div id="top-bar">
        Tokens: <span id="token-count">50,000</span>
    </div>

    <div class="container">
        <h1>Roman Market</h1>
        <button class="pack-btn" onclick="openConfirm()">Open Roman Pack (1,000 Tokens)</button>
        
        <h2 style="margin-top: 40px; border-top: 1px solid #2c3e50; padding-top: 20px;">My Collection</h2>
        <div id="collection"></div>
    </div>

    <div id="confirmBox">
        <div class="modal-content">
            <h2 style="color:white; margin-top:0;">Open Roman Pack?</h2>
            <p style="color:#bdc3c7;">This will cost 1,000 tokens.</p>
            <div style="display: flex; justify-content: center;">
                <button onclick="startOpening()" style="background:#2ecc71; color:white;">Yes, Open!</button>
                <button onclick="closeConfirm()" style="background:#e74c3c; color:white;">No, Go Back</button>
            </div>
        </div>
    </div>

    <script>
        // --- DATA SYSTEM ---
        let userTokens = parseInt(localStorage.getItem('tokens')) || 50000;
        let myBlooks = JSON.parse(localStorage.getItem('myBlooks')) || [];

        function saveData() {
            localStorage.setItem('tokens', userTokens);
            localStorage.setItem('myBlooks', JSON.stringify(myBlooks));
        }

        function updateDisplay() {
            document.getElementById('token-count').innerText = userTokens.toLocaleString();
            const collectionDiv = document.getElementById('collection');
            collectionDiv.innerHTML = '';

            myBlooks.forEach((blook, index) => {
                const card = document.createElement('div');
                card.className = 'blook-card';
                card.style.borderBottomColor = blook.color;
                
                // Sell prices based on rarity
                let sellPrice = 100;
                if (blook.rarity === 'Rare') sellPrice = 200;
                if (blook.rarity === 'Epic') sellPrice = 500;
                if (blook.rarity === 'Legendary') sellPrice = 10000;

                card.innerHTML = `
                    <div style="font-weight:bold; font-size: 18px;">${blook.name}</div>
                    <div style="font-size:12px; color:${blook.color}; font-weight:bold; margin-top:5px;">${blook.rarity.toUpperCase()}</div>
                    <button class="sell-btn" onclick="sellBlook(${index}, ${sellPrice})">Sell for ${sellPrice}</button>
                `;
                collectionDiv.appendChild(card);
            });
        }

        // --- MODAL SYSTEM ---
        function openConfirm() {
            document.getElementById('confirmBox').style.display = 'flex';
        }

        function closeConfirm() {
            document.getElementById('confirmBox').style.display = 'none';
        }

        // --- PACK OPENING SYSTEM ---
        function startOpening() {
            closeConfirm();

            if (userTokens < 1000) {
                alert("You don't have enough tokens to open this pack!");
                return;
            }

            userTokens -= 1000;
            let roll = Math.random() * 100;
            let result;

            // Rarity Logic (Colors: Green, Blue, Red, Yellow)
            if (roll < 5) { // 5% Chance
                result = { name: 'Julius Caesar', rarity: 'Legendary', color: '#ffff00' };
            } else if (roll < 15) { // 10% Chance
                result = { name: 'Gladiator', rarity: 'Epic', color: '#ff0000' };
            } else if (roll < 40) { // 25% Chance
                result = { name: 'Centurion', rarity: 'Rare', color: '#0000ff' };
            } else { // 60% Chance
                result = { name: 'Roman Soldier', rarity: 'Common', color: '#00ff00' };
            }

            myBlooks.unshift(result);
            saveData();
            updateDisplay();

            alert(`✨ PACK OPENED ✨\n\nYou pulled: ${result.name}!\nRarity: ${result.rarity}`);
        }

        // --- SELLING SYSTEM ---
        function sellBlook(index, amount) {
            const blookName = myBlooks[index].name;
            if (confirm(`Sell ${blookName} for ${amount} tokens?`)) {
                userTokens += amount;
                myBlooks.splice(index, 1);
                saveData();
                updateDisplay();
            }
        }

        // Initial Start
        updateDisplay();
    </script>
</body>
</html>
